{"ast":null,"code":"var _jsxFileName = \"/Users/alvinneri/Desktop/Projects/PMS Mobile/property-management-mobile/employee-app/screens/auth/login/index.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { FC, useEffect, useState } from \"react\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { db, auth } from \"../../../firebase/config\";\nimport { TextInput, Button } from \"react-native-paper\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { useForm } from \"react-hook-form\";\nimport Toast from \"react-native-toast-message\";\nimport { useDispatch } from \"react-redux\";\nimport { setLoading, setUser } from \"../../../redux/public/actions\";\nexport default function LoginScreen() {\n  var navigation = useNavigation();\n  var dispatch = useDispatch();\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      setValue = _useForm.setValue,\n      handleSubmit = _useForm.handleSubmit,\n      errors = _useForm.errors,\n      reset = _useForm.reset;\n\n  useEffect(function () {\n    register({\n      name: \"email\"\n    }, {\n      required: true\n    });\n    register({\n      name: \"password\"\n    }, {\n      required: true\n    });\n  }, []);\n\n  var setUserLogin = function setUserLogin(values) {\n    var jsonValue;\n    return _regeneratorRuntime.async(function setUserLogin$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            jsonValue = JSON.stringify(values);\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@user\", jsonValue));\n\n          case 4:\n            dispatch(setUser(values));\n            dispatch(setLoading(false));\n            Toast.show({\n              position: \"bottom\",\n              text1: \"Successfully login\"\n            });\n            navigation.navigate(\"Home\");\n            _context.next = 14;\n            break;\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context[\"catch\"](0);\n            dispatch(setLoading(false));\n            console.log(_context.t0);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 10]], Promise);\n  };\n\n  var login = function login(values, e) {\n    var response, user;\n    return _regeneratorRuntime.async(function login$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            dispatch(setLoading(true));\n            _context2.prev = 1;\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(auth.signInWithEmailAndPassword(values.email, values.password));\n\n          case 4:\n            response = _context2.sent;\n\n            if (!(response && response.user)) {\n              _context2.next = 23;\n              break;\n            }\n\n            _context2.prev = 6;\n            _context2.next = 9;\n            return _regeneratorRuntime.awrap(db.collection(\"users\").doc(response.user.uid).get());\n\n          case 9:\n            user = _context2.sent;\n\n            if (!(user.data().userType === \"EMPLOYEE\")) {\n              _context2.next = 15;\n              break;\n            }\n\n            _context2.next = 13;\n            return _regeneratorRuntime.awrap(setUserLogin(user.data()));\n\n          case 13:\n            _context2.next = 17;\n            break;\n\n          case 15:\n            dispatch(setLoading(false));\n            Toast.show({\n              type: \"error\",\n              position: \"bottom\",\n              text1: \"Login as Employee\"\n            });\n\n          case 17:\n            _context2.next = 23;\n            break;\n\n          case 19:\n            _context2.prev = 19;\n            _context2.t0 = _context2[\"catch\"](6);\n            dispatch(setLoading(false));\n            console.log(_context2.t0);\n\n          case 23:\n            _context2.next = 29;\n            break;\n\n          case 25:\n            _context2.prev = 25;\n            _context2.t1 = _context2[\"catch\"](1);\n            dispatch(setLoading(false));\n            Toast.show({\n              type: \"error\",\n              position: \"bottom\",\n              text1: _context2.t1.message\n            });\n\n          case 29:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 25], [6, 19]], Promise);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: 30,\n      marginVertical: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, \"Welcome to 360 PMS\"), React.createElement(TextInput, {\n    name: \"email\",\n    autoCapitalize: \"none\",\n    style: {\n      width: 300,\n      marginBottom: 10\n    },\n    label: \"Email Address\",\n    onChangeText: function onChangeText(text) {\n      return setValue(\"email\", text, true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }), React.createElement(TextInput, {\n    name: \"password\",\n    secureTextEntry: true,\n    autoCapitalize: \"none\",\n    style: {\n      width: 300,\n      marginBottom: 10\n    },\n    label: \"Password\",\n    onChangeText: function onChangeText(text) {\n      return setValue(\"password\", text, true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }), React.createElement(TouchableOpacity, {\n    style: {\n      marginRight: 50,\n      marginVertical: 10,\n      alignSelf: \"flex-end\"\n    },\n    onPress: function onPress() {\n      navigation.navigate(\"ForgotPassword\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }, \"Forgot Password?\")), React.createElement(Button, {\n    mode: \"contained\",\n    style: {\n      width: 300,\n      marginBottom: 10,\n      padding: 10\n    },\n    onPress: handleSubmit(login),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, \"LOGIN\"));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: \"bold\"\n  },\n  separator: {\n    marginVertical: 30,\n    height: 1,\n    width: \"80%\"\n  }\n});","map":{"version":3,"sources":["/Users/alvinneri/Desktop/Projects/PMS Mobile/property-management-mobile/employee-app/screens/auth/login/index.js"],"names":["React","FC","useEffect","useState","useNavigation","db","auth","TextInput","Button","AsyncStorage","useForm","Toast","useDispatch","setLoading","setUser","LoginScreen","navigation","dispatch","register","setValue","handleSubmit","errors","reset","name","required","setUserLogin","values","jsonValue","JSON","stringify","setItem","show","position","text1","navigate","console","log","login","e","signInWithEmailAndPassword","email","password","response","user","collection","doc","uid","get","data","userType","type","message","styles","container","fontSize","marginVertical","width","marginBottom","text","marginRight","alignSelf","padding","StyleSheet","create","flex","alignItems","justifyContent","title","fontWeight","separator","height"],"mappings":"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","sourcesContent":["import React, { FC, useEffect, useState } from \"react\";\nimport {\n  Platform,\n  StyleSheet,\n  Text,\n  View,\n  TouchableOpacity,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { db, auth } from \"../../../firebase/config\";\nimport { TextInput, Button } from \"react-native-paper\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { useForm } from \"react-hook-form\";\nimport Toast from \"react-native-toast-message\";\nimport { useDispatch } from \"react-redux\";\nimport { setLoading, setUser } from \"../../../redux/public/actions\";\n\nexport default function LoginScreen() {\n  const navigation = useNavigation();\n  const dispatch = useDispatch();\n  const { register, setValue, handleSubmit, errors, reset } = useForm();\n\n  useEffect(() => {\n    register({ name: \"email\" }, { required: true });\n    register({ name: \"password\" }, { required: true });\n  }, []);\n\n  const setUserLogin = async (values) => {\n    try {\n      const jsonValue = JSON.stringify(values);\n      await AsyncStorage.setItem(\"@user\", jsonValue);\n      dispatch(setUser(values));\n      dispatch(setLoading(false));\n      Toast.show({\n        position: \"bottom\",\n        text1: \"Successfully login\",\n      });\n      navigation.navigate(\"Home\");\n    } catch (err) {\n      dispatch(setLoading(false));\n      console.log(err);\n    }\n  };\n\n  const login = async (values, e) => {\n    dispatch(setLoading(true));\n\n    try {\n      const response = await auth.signInWithEmailAndPassword(\n        values.email,\n        values.password\n      );\n\n      if (response && response.user) {\n        try {\n          const user = await db\n            .collection(\"users\")\n            .doc(response.user.uid)\n            .get();\n\n          if (user.data().userType === \"EMPLOYEE\") {\n            await setUserLogin(user.data());\n          } else {\n            dispatch(setLoading(false));\n            Toast.show({\n              type: \"error\",\n              position: \"bottom\",\n              text1: \"Login as Employee\",\n            });\n          }\n        } catch (err) {\n          dispatch(setLoading(false));\n          console.log(err);\n        }\n      }\n    } catch (err) {\n      dispatch(setLoading(false));\n      Toast.show({\n        type: \"error\",\n        position: \"bottom\",\n        text1: err.message,\n      });\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <Text style={{ fontSize: 30, marginVertical: 20 }}>\n        Welcome to 360 PMS\n      </Text>\n      <TextInput\n        name=\"email\"\n        autoCapitalize=\"none\"\n        style={{ width: 300, marginBottom: 10 }}\n        label=\"Email Address\"\n        onChangeText={(text) => setValue(\"email\", text, true)}\n      />\n      <TextInput\n        name=\"password\"\n        secureTextEntry={true}\n        autoCapitalize=\"none\"\n        style={{ width: 300, marginBottom: 10 }}\n        label=\"Password\"\n        onChangeText={(text) => setValue(\"password\", text, true)}\n      />\n      <TouchableOpacity\n        style={{ marginRight: 50, marginVertical: 10, alignSelf: \"flex-end\" }}\n        onPress={() => {\n          navigation.navigate(\"ForgotPassword\");\n        }}\n      >\n        <Text>Forgot Password?</Text>\n      </TouchableOpacity>\n      <Button\n        mode=\"contained\"\n        style={{ width: 300, marginBottom: 10, padding: 10 }}\n        onPress={handleSubmit(login)}\n      >\n        LOGIN\n      </Button>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n  },\n  separator: {\n    marginVertical: 30,\n    height: 1,\n    width: \"80%\",\n  },\n});\n"]},"metadata":{},"sourceType":"module"}